function bindEvents(){$("[data-tag=black]").on("click",function(e){var a=$(this);"加入黑名单"==a.html()?(showDialog({txt:"已添加黑名单",confirm:"确认"}),sendFn({r:"/userset/set-black",black_uid:UID},function(e){$("#loading").hide(),200==e.code?(a.html("解除黑名单"),console.log(e)):showDialog({txt:e.msg,confirm:"确认"})})):(showDialog({txt:"已解除黑名单",confirm:"确认"}),sendFn({r:"/userset/del-black",black_uid:UID},function(e){$("#loading").hide(),200==e.code?(a.html("加入黑名单"),console.log(e)):showDialog({txt:e.msg,confirm:"确认"})}))}),$("#black i").on("click",function(e){e.stopPropagation();var a=$(this).offset().left,t=$(this).offset().top;$("#blackMenu").css({top:t+25,left:a-30}).toggle()}),$(".article-list li").on("click","p",function(){$(this).addClass("show")}),$(".article-list li").on("dblclick","p",function(){$(this).removeClass("show")}),$("#comment").on("click",".close",function(e){e.stopPropagation(),$(this).parent().hide(),$("#overlay").hide()}),$(".article-list").on("click","[data-tag]",function(e){e.stopPropagation();var a=$(this);switch(name=a.data("tag"),fid=a.data("id"),opts={},name){case"up":sendFn({r:"/feed/digg",feed_id:fid},function(e){$("#loading").hide(),200==e.code?(a.toggleClass("active"),console.log(e)):showDialog({txt:e.msg,confirm:"确认"})});break;case"more":hideDialogs();var t=$(this).siblings("[data-menu=more]");showDownMenu(t,$(this));break;case"share":hideDialogs();var t=$(this).siblings("[data-menu=share]");showDownMenu(t,$(this));break;case"collect":hideDialogs(),showDialog({txt:"已收藏",confirm:"确认"});break;case"copy":break;case"comment":var s=$(this).parents(".dream-wrap"),i=s.find(".title span"),o=s.offset().left,c=s.width();FeedID=fid,showComment(i,o,c);break;case"private":hideDialogs();var a=$(this),r=a.parentsUntil(".actions").siblings(".private"),n=Number(a.data("type"));sendFn({r:"/feed/set-feed-secret",feed_id:fid,show_type:3-n},function(e){200==e.code?(r.toggle(),a.data("type",3-n),a.html(["设为公开","设为私密"][n-1])):showDialog({txt:e.msg,confirm:"确认"})});break;case"facebook":if(showShare())break;generate("https://www.facebook.com/sharer/sharer.php?u=(sUrl)",getShareOpts.call(this));break;case"weibo":if(showShare())break;generate("http://service.weibo.com/share/share.php?url=(sUrl)&title=(sTitle)&pic=(sPic)",getShareOpts.call(this));break;case"douban":if(showShare())break;generate("https://www.douban.com/share/service?image=(sPic)&href=(sUrl)&name=(sTitle)&text=(sDesc)",getShareOpts.call(this));break;case"qq":if(showShare())break;generate("http://connect.qq.com/widget/shareqq/index.html?url=(sUrl)&title=(sTitle)&source=(sDesc)",getShareOpts.call(this));break;case"wechat":if(showShare())break;showWX(getShareOpts.call(this));break;case"whatsapp":if(showShare())break;generate("whatsapp://send?text=(sDesc)"+encodeURIComponent("\n\n")+"(sUrl)&via=lopscoop",getShareOpts.call(this))}})}var FeedID=0,match=location.pathname.match(/\/tag\/\d+\/([^\/]+)/),TagName=match&&match[1]||"";setCopyUrl(),bindEvents(),scrollPage({r:"/user/get-tag-feed-list",uid:UID,tag_name:TagName});